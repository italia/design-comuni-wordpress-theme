!function(){const l=document.querySelector(".container-assistenza");async function e(){const r=l.querySelector(".steppers-content");if(r){var e=r.querySelector("#category");if(e){const o=r.querySelector("#service");o&&(e.addEventListener("change",async e=>{r=o,t=r.firstElementChild,r.innerHTML="",r.append(t),r.disabled=!0;var t=e.target.value;if(t){var r=await async function(e){try{return await(await fetch(window.wpRestApi+"wp/v2/servizi"+(e?"?categorie_servizio="+e:""))).json()}catch(e){console.error(e)}}(t);if(Array.isArray(r)){for(servizio of r){var a=servizio?.title?.rendered,n=document.createElement("option");n.value=a,n.text=a,o.add(n)}1<o.childElementCount&&(o.disabled=!1)}}}),r.addEventListener("submit",async()=>{var e,t=r.querySelector(".errorFeedback"),t=(t&&t.remove(),await async function(){try{var e=l.querySelector('[name="name"]').value,t=l.querySelector('[name="surname"]').value,r=l.querySelector('[name="email"]').value,a=l.querySelector("#category").value,n=l.querySelector("#service").value,o=l.querySelector("#description").value,c=l.querySelector("#privacy").checked,i={title:"ticket_"+(new Date).toISOString(),nome:e,cognome:t,email:r,categoria_servizio:a,servizio:n,dettagli:o,privacyChecked:c},s=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return 0<(Object.values(i)?.filter(e=>!e))?.length||!s.test(r)?!1:(await fetch(data_assistenza.url,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:new URLSearchParams({action:"save_richiesta_assistenza",...i})})).ok}catch(e){console.error(e)}}());t?(document.getElementById("first-step").classList.add("d-none"),document.getElementById("email-recap").innerText=l.querySelector('[name="email"]').value,document.getElementById("second-step").classList.remove("d-none"),(t=document.querySelector(".menu-wrapper"))&&t.scrollIntoView({behavior:"smooth"})):((t=document.createElement("p")).classList.add("form-feedback","just-validate-error-label","ms-0"),t.innerText="something went wrong, try again",(e=document.createElement("div")).classList.add("errorFeedback"),e.appendChild(t),t=e,(e=r.querySelector(".privacy-wrapper"))&&r.insertBefore(t,e))}))}}}l&&e()}();