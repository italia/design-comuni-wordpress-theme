import*as DOM from"../lib/dom";import updateGeometry from"../update-geometry";import{isEditable}from"../lib/util";export default function(a){const i=a.element;a.event.bind(a.ownerDocument,"keydown",r=>{if(!(r.isDefaultPrevented&&r.isDefaultPrevented()||r.defaultPrevented)&&(DOM.matches(i,":hover")||DOM.matches(a.scrollbarX,":focus")||DOM.matches(a.scrollbarY,":focus"))){let e=document.activeElement||a.ownerDocument.activeElement;if(e){if("IFRAME"===e.tagName)e=e.contentDocument.activeElement;else for(;e.shadowRoot;)e=e.shadowRoot.activeElement;if(isEditable(e))return}let t=0,n=0;switch(r.which){case 37:t=r.metaKey?-a.contentWidth:r.altKey?-a.containerWidth:-30;break;case 38:n=r.metaKey?a.contentHeight:r.altKey?a.containerHeight:30;break;case 39:t=r.metaKey?a.contentWidth:r.altKey?a.containerWidth:30;break;case 40:n=r.metaKey?-a.contentHeight:r.altKey?-a.containerHeight:-30;break;case 32:n=r.shiftKey?a.containerHeight:-a.containerHeight;break;case 33:n=a.containerHeight;break;case 34:n=-a.containerHeight;break;case 36:n=a.contentHeight;break;case 35:n=-a.contentHeight;break;default:return}a.settings.suppressScrollX&&0!==t||a.settings.suppressScrollY&&0!==n||(i.scrollTop-=n,i.scrollLeft+=t,updateGeometry(a),!function(e,t){var n=Math.floor(i.scrollTop);if(0===e){if(!a.scrollbarYActive)return;if(0===n&&0<t||n>=a.contentHeight-a.containerHeight&&t<0)return!a.settings.wheelPropagation}if(n=i.scrollLeft,0===t){if(!a.scrollbarXActive)return;if(0===n&&e<0||n>=a.contentWidth-a.containerWidth&&0<e)return!a.settings.wheelPropagation}return 1}(t,n))||r.preventDefault()}})}