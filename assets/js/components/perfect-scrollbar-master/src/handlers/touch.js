import updateGeometry from"../update-geometry";import cls from"../lib/class-names";import*as CSS from"../lib/css";import{env}from"../lib/util";export default function(s){if(env.supportsTouch||env.supportsIePointer){const f=s.element;let i={},a=0,l={},t=null;function c(e,t){f.scrollTop-=t,f.scrollLeft-=e,updateGeometry(s)}function p(e){return e.targetTouches?e.targetTouches[0]:e}function u(e){return(!e.pointerType||"pen"!==e.pointerType||0!==e.buttons)&&(e.targetTouches&&1===e.targetTouches.length||e.pointerType&&"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE)}function e(e){u(e)&&(e=p(e),i.pageX=e.pageX,i.pageY=e.pageY,a=(new Date).getTime(),null!==t)&&clearInterval(t)}function n(e){var t,n,o,r;u(e)&&(t=(o={pageX:(o=p(e)).pageX,pageY:o.pageY}).pageX-i.pageX,n=o.pageY-i.pageY,!function(t,n,o){if(f.contains(t)){let e=t;for(;e&&e!==f;){if(e.classList.contains(cls.element.consuming))return 1;var r=CSS.get(e);if(o&&r.overflowY.match(/(scroll|auto)/)){var i=e.scrollHeight-e.clientHeight;if(0<i&&(0<e.scrollTop&&o<0||e.scrollTop<i&&0<o))return 1}if(n&&r.overflowX.match(/(scroll|auto)/)&&0<(i=e.scrollWidth-e.clientWidth)&&(0<e.scrollLeft&&n<0||e.scrollLeft<i&&0<n))return 1;e=e.parentNode}}}(e.target,t,n))&&(c(t,n),i=o,0<(r=(o=(new Date).getTime())-a)&&(l.x=t/r,l.y=n/r,a=o),function(e,t){var n=Math.floor(f.scrollTop),o=(f.scrollLeft,Math.abs(e)),r=Math.abs(t);if(o<r){if(t<0&&n===s.contentHeight-s.containerHeight||0<t&&0===n)return 0===window.scrollY&&0<t&&env.isChrome}else r<o&&e<0&&(s.contentWidth,s.containerWidth);return 1}(t,n))&&e.preventDefault()}function o(){s.settings.swipeEasing&&(clearInterval(t),t=setInterval(function(){s.isInitialized||!l.x&&!l.y||Math.abs(l.x)<.01&&Math.abs(l.y)<.01?clearInterval(t):(c(30*l.x,30*l.y),l.x*=.8,l.y*=.8)},10))}env.supportsTouch?(s.event.bind(f,"touchstart",e),s.event.bind(f,"touchmove",n),s.event.bind(f,"touchend",o)):env.supportsIePointer&&(window.PointerEvent?(s.event.bind(f,"pointerdown",e),s.event.bind(f,"pointermove",n),s.event.bind(f,"pointerup",o)):window.MSPointerEvent&&(s.event.bind(f,"MSPointerDown",e),s.event.bind(f,"MSPointerMove",n),s.event.bind(f,"MSPointerUp",o)))}}